<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zing Coin - Global Rank</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background-color: #050505; color: white; min-height: 100vh; padding: 20px; padding-bottom: 100px; }

        .header { text-align: center; margin-bottom: 30px; }
        .header h1 { font-size: 24px; font-weight: 800; color: #fff; letter-spacing: 1px; }
        .header span { color: #ffd700; }

        /* Leaderboard Table */
        .rank-container { width: 100%; max-width: 400px; margin: 0 auto; }
        
        .rank-item {
            background: #111;
            padding: 12px 18px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 12px;
            border: 1px solid #222;
            transition: 0.3s;
        }

        /* Top 3 Stylings */
        .rank-item.gold { border-color: #ffd700; background: linear-gradient(90deg, #111, #1a1600); box-shadow: 0 0 15px rgba(255, 215, 0, 0.1); }
        .rank-item.silver { border-color: #c0c0c0; }
        .rank-item.bronze { border-color: #cd7f32; }

        .left-side { display: flex; align-items: center; gap: 15px; }
        .rank-num { font-weight: 800; font-size: 18px; width: 25px; color: #444; }
        .gold .rank-num { color: #ffd700; }
        
        /* Avatar Placeholder */
        .rank-avatar { width: 40px; height: 40px; background: #222; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; }

        .user-info .u-name { font-size: 14px; font-weight: 600; color: #eee; }
        .user-info .u-id { font-size: 10px; color: #555; }

        .right-side { text-align: right; }
        .coin-amount { color: #00d2ff; font-weight: 800; font-size: 15px; display: flex; align-items: center; gap: 5px; }
        .coin-amount i { color: #ffd700; font-size: 12px; }

        /* Bottom Nav */
        .footer { position: fixed; bottom: 0; left: 0; width: 100%; display: flex; justify-content: space-around; padding: 18px; background: #0a0a0a; border-top: 1px solid #1a1a1a; border-radius: 20px 20px 0 0; }
        .nav-item { color: #444; font-size: 11px; text-align: center; text-decoration: none; font-weight: 700; display: flex; flex-direction: column; gap: 5px; }
        .nav-item.active { color: #ffd700; }
        .nav-item i { font-size: 22px; }

        #loading-text { text-align: center; color: #555; margin-top: 50px; font-size: 14px; }
    </style>
</head>
<body>

    <div class="header">
        <p style="font-size: 10px; color: #777; text-transform: uppercase; letter-spacing: 2px;">Global Board</p>
        <h1>TOP <span>PLAYERS</span></h1>
    </div>

    <div class="rank-container" id="rankList">
        <div id="loading-text">Loading Leaderboard...</div>
    </div>

    <div class="footer">
        <a href="home.html" class="nav-item"><i class="fas fa-gamepad"></i><span>Home</span></a>
        <a href="rank.html" class="nav-item active"><i class="fas fa-trophy"></i><span>Rank</span></a>
        <a href="friends.html" class="nav-item"><i class="fas fa-user-group"></i><span>Friends</span></a>
        <a href="payout.html" class="nav-item"><i class="fas fa-wallet"></i><span>Payout</span></a>
    </div>

    <script>
        // --- 1. FIREBASE CONFIG ---
        const firebaseConfig = {
            apiKey: "AIzaSyA5A8qm5QIvqVaGbuz8j8w-ZJ3W0p96qpQ",
            databaseURL: "https://zing-coin-default-rtdb.firebaseio.com",
            projectId: "zing-coin",
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function fetchLeaderboard() {
            // Coins අනුව වැඩිම 15 දෙනා ගමු
            db.ref('users').orderByChild('coins').limitToLast(15).on('value', (snapshot) => {
                const rankList = document.getElementById('rankList');
                rankList.innerHTML = '';
                
                let players = [];
                snapshot.forEach(child => {
                    players.push(child.val());
                });

                // Firebase දෙන්නේ අඩුම කෙනාගෙ ඉඳන් වැඩිම කෙනාට නිසා Reverse කරනවා
                players.reverse();

                players.forEach((player, index) => {
                    const pos = index + 1;
                    let rankClass = "";
                    let medal = "";

                    if(pos === 1) { rankClass = "gold"; medal = '<i class="fas fa-crown"></i>'; }
                    else if(pos === 2) { rankClass = "silver"; }
                    else if(pos === 3) { rankClass = "bronze"; }

                    rankList.innerHTML += `
                        <div class="rank-item ${rankClass}">
                            <div class="left-side">
                                <span class="rank-num">${pos}</span>
                                <div class="rank-avatar" style="color: ${player.color || '#fff'}">
                                    <i class="fas ${player.avatar || 'fa-user'}"></i>
                                </div>
                                <div class="user-info">
                                    <div class="u-name">${player.username} ${medal}</div>
                                    <div class="u-id">ID: ${player.id}</div>
                                </div>
                            </div>
                            <div class="right-side">
                                <div class="coin-amount">
                                    ${player.coins.toLocaleString()} <i class="fas fa-coins"></i>
                                </div>
                            </div>
                        </div>
                    `;
                });
            });
        }

        window.onload = fetchLeaderboard;
    </script>
</body>
</html>